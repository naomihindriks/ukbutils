# UK Biobank Utilities

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT) [![Test](https://github.com/naomihindriks/ukbutils/actions/workflows/testing.yml/badge.svg)](https://github.com/naomihindriks/ukbutils/actions/workflows/testing.yml) ![Python Version from PEP 621 TOML](https://img.shields.io/python/required-version-toml?tomlFilePath=https%3A%2F%2Fraw.githubusercontent.com%2Fnaomihindriks%2Fukbutils%2Fmain%2Fpyproject.toml%3Ftoken%3DGHSAT0AAAAAACS274G3WAJAMT4FN5ERWIBMZS4HAVA)


## Overview

This Python package provides tools to interact with the UK Biobank data. It includes functionalities for translating coded values to human-readable values, converting UK Biobank TSV files to Parquet format, and various utility functions for data analysis.

## Features

- **UKB_DataDict Class**: Translates coded values to human-readable values.
- **TSV to Parquet Conversion**: Converts UK Biobank TSV files to Parquet format for efficient storage and processing.

## Installation

This package is not available on PyPI. You can install it by cloning the repository from GitHub and then using pip to install it.

### Prerequisites

- Python 3.9, 3.10, 3.11, or 3.12

### Steps

1. Clone the repository:

    ```bash
    git clone https://github.com/yourusername/ukb-utils.git
    ```

2. Navigate to the directory:

    ```bash
    cd ukb-utils
    ```

3. Install the package:

    ```bash
    pip install .
    ```

## Usage

### Translating Coded Values

The `UKB_DataDict` class helps in working with UK Biobank Data Dictionary HTML files generated by the 'ukbconv' utility. It can parse and extract relevant information from the HTML file, and translate coded values to human-readable values.

#### Example Usage

1. **Initialize the Data Dictionary**

    ```python
    from ukb_utils import UKB_DataDict

    # Initialize the data dictionary
    data_dict = UKB_DataDict('/path/to/data/dictionary.html')
    ```

2. **Retrieve the Main Table**

    ```python
    main_table = data_dict.main_table
    print(main_table.head())
    ```

3. **Get Metadata Information**

    ```python
    info = data_dict.info
    print(info)
    ```

4. **Get an Encoding Table**

    ```python
    encoding_table = data_dict.get_encoding_table(encoding_id=89)
    print(encoding_table.head())
    ```

5. **Translate a Data Field to Human-Readable Name**

    ```python
    human_readable_name = data_dict.get_human_readable_name(field_id='field_id_value', is_udi=True)
    print(human_readable_name)
    ```

### Converting TSV to Parquet (Command Line)

Convert a UK Biobank TSV file to Parquet format using the command line.
This convertion can be done with and without a configuration file.


```bash
ukb-to-parquet 
```
